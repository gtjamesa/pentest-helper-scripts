#!/usr/bin/env python3
import sys
import argparse
import os.path

#
# Username Generator
#
# Credit to superkojiman for posting the original on GitHub
# https://gist.github.com/superkojiman/11076951
#


def split_name(name):
    tokens = name.lower().split()
    names = []

    fname = tokens[0]
    lname = tokens[-1]

    names.append(fname + lname)             # johndoe
    names.append(lname + fname)             # doejohn
    names.append(fname + "." + lname)       # john.doe
    names.append(lname + "." + fname)       # doe.john
    names.append(lname + fname[0])          # doej
    names.append(lname[0:3] + fname)        # johdoe
    names.append(fname[0:3] + lname)        # johdoe
    names.append(fname[0] + lname)          # jdoe
    names.append(lname[0] + fname)          # djoe
    names.append(fname[0] + "." + lname)    # j.doe
    names.append(lname[0] + "." + fname)    # d.john
    names.append(lname[0:3] + "." + fname)  # doe.john
    names.append(fname[0:3] + "." + lname)  # joh.doe
    names.append(fname)                     # john
    names.append(lname)                     # joe

    write_names(names)


def write_names(names):
    names = list(dict.fromkeys(names))  # Remove duplicates

    for name in names:
        if args.append:
            name = name + args.append
        print(name)


def read_file():
    for line in open(args.file, 'r'):
        name = ''.join([c for c in line if c == " " or c.isalpha()])
        split_name(name)


def main():
    if args.file:
        if not os.path.exists(args.file):
            print("{} not found".format(args.file))
            sys.exit(0)

        read_file()

    elif args.name:
        name = ' '.join(args.name) if type(args.name) is list else args.name
        split_name(name)

    sys.exit(0)


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("-n", "--name", nargs='+',
                        help="Enter a name (firstname lastname)")
    parser.add_argument("-f", "--file",
                        help="Path to file containing names")
    parser.add_argument("-a", "--append",
                        help="Append to each username (i.e. email domain)")
    args = parser.parse_args()

    if not args.name and not args.file:
        parser.print_help()
        sys.exit(0)

    main()
