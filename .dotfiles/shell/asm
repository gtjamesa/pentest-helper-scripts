#!/bin/bash

dump-shellcode() {
    accum=0
    sentry="No nulls found"
    for i in $(objdump -d "${1}" | grep "^ " | cut -f 2); do
        echo -n '\x'$i
        accum=$((accum + 1))
        if [[ "${i}" = "00" ]]; then
            sentry="You have nulls, try again"
        fi
    done
    echo && echo "length of shellcode: $accum"
    echo "${sentry}"
}

assemble() {
    name="${1}"
    base="$(basename ${name} .nasm)"
    base="$(basename ${base} .asm)"
    nasm -f elf64 "${name}" -o "${base}".o
    ld "${base}".o -o "${base}"
}
