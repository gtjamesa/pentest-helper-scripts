#!/bin/bash

rustscan() {
  docker run -it --rm --name rustscan rustscan/rustscan:2.0.1 "$@" -- -Pn
}

s-autorecon() {
  sudo $(which autorecon) "$@"
}

clean-hydra() {
  HYDRA_FILES=$(sudo find "$HOME" -type f -name hydra.restore -print0)
  FEROX_FILES=$(sudo find "$HOME" -type f -name 'ferox-*.state' -print0)

  echo -n $HYDRA_FILES | xargs -0 sudo du -sh
  echo -n $HYDRA_FILES | xargs -0 sudo rm -f
  echo -n $FEROX_FILES | xargs -0 sudo du -sh
  echo -n $FEROX_FILES | xargs -0 sudo rm -f
}

scrape-wordlist() {
  if [[ -z "$1" ]]; then
    echo 'Run a directory scan against the target, then re-run this script with the name of the file'
    echo '\033[1;34m$\033[0m \033[0;32mferoxbuster --depth 1 -x php txt html -Bern -u http://10.10.110.100 > ferox.txt\033[0m'
    return 1
  fi

  # Sanitize the list
  cat "$1" | grep 200 | grep -v "\.jpg\|\.jpeg\|\.png\|\.js\|\.css\|\.eot\|\.ttf\|\.otf\|\.svg\|\.gif\|\.woff\|\.woff2\|\.zip\|\s0c" | cut -d 'h' -f2-100 | sed 's/^/h/g' > temp_urls.txt

  # Run CeWL against each URL
  total_urls=$(wc -l temp_urls.txt | cut -d' ' -f 1)
  for url in $(cat temp_urls.txt); do echo $url && cewl --with-numbers -d 1 $url | grep -v 'digi.ninja' >> temp_cewl.txt; done
  rm -f temp_urls.txt
  cat temp_cewl.txt | sort -u >> cewl.txt && rm -f temp_cewl.txt
  total_words=$(wc -l cewl.txt | cut -d' ' -f 1)
  echo
  echo -e "\033[0;32mCreated $total_words line wordlist from $total_urls URLs\033[0m"
}